# 🚀 Railway + GitHub Pages 部署详细步骤

## 📋 部署架构

```
前端 (GitHub Pages) ←→ 后端API (Railway)
https://用户名.github.io/仓库名 ←→ https://your-app.railway.app
```

## 🎯 第一步：创建GitHub仓库

### 1.1 注册/登录GitHub
- 访问 [github.com](https://github.com)
- 如果没有账号，点击 "Sign up" 注册
- 如果有账号，点击 "Sign in" 登录

### 1.2 创建新仓库
1. 点击右上角的 "+" 号
2. 选择 "New repository"
3. 填写仓库信息：
   - **Repository name**: `china-travel-recommender` (或您喜欢的名称)
   - **Description**: `中国旅游城市随机推荐工具`
   - 选择 **Public** (GitHub Pages需要公开仓库)
   - **不要**勾选 "Add a README file"
   - **不要**勾选 "Add .gitignore"
   - **不要**勾选 "Choose a license"
4. 点击 "Create repository"

### 1.3 准备部署文件

在您的项目目录中执行以下命令：

```bash
# 进入项目目录
cd /Users/huluwa/WorkSpace/fun

# 运行部署准备脚本
chmod +x deploy.sh
./deploy.sh
```

### 1.4 上传代码到GitHub

```bash
# 初始化Git仓库
git init

# 添加所有文件
git add .

# 提交更改
git commit -m "Initial commit: 中国旅游城市推荐工具"

# 重命名主分支为main
git branch -M main

# 添加远程仓库（请替换为您的实际仓库URL）
git remote add origin https://github.com/您的用户名/china-travel-recommender.git

# 推送到GitHub
git push -u origin main
```

**注意**: 请将 `您的用户名` 和 `china-travel-recommender` 替换为您的实际GitHub用户名和仓库名。

## 🚂 第二步：部署后端到Railway

### 2.1 注册Railway账号
1. 访问 [railway.app](https://railway.app)
2. 点击 "Login"
3. 选择 "Login with GitHub"
4. 授权Railway访问您的GitHub账号

### 2.2 创建新项目
1. 在Railway控制台点击 "New Project"
2. 选择 "Deploy from GitHub repo"
3. 选择您刚创建的仓库 `china-travel-recommender`
4. 点击 "Deploy Now"

### 2.3 配置部署
Railway会自动检测到Python项目，但我们需要确认配置：

1. **检查部署配置**：
   - Railway会自动使用 `railway.json` 配置
   - 确认使用 `server.py` 作为入口文件
   - 确认使用 `requirements.txt` 安装依赖

2. **等待部署完成**：
   - 部署过程大约需要2-5分钟
   - 您可以在Railway控制台看到部署日志

3. **获取部署URL**：
   - 部署完成后，您会看到类似 `https://your-app.railway.app` 的URL
   - **重要**: 请记录这个URL，稍后需要用到

### 2.4 测试后端API
在浏览器中访问您的Railway URL，应该能看到：
- 主页显示城市推荐工具
- API接口 `https://your-app.railway.app/api/random-cities?count=5` 返回JSON数据

## 📄 第三步：配置GitHub Pages

### 3.1 启用GitHub Pages
1. 回到您的GitHub仓库页面
2. 点击 "Settings" 标签
3. 滚动到左侧菜单的 "Pages" 部分
4. 在 "Source" 下选择 "Deploy from a branch"
5. 选择 "main" 分支和 "/ (root)" 文件夹
6. 点击 "Save"

### 3.2 获取前端URL
几分钟后，您的前端将在以下URL可访问：
`https://您的用户名.github.io/china-travel-recommender`

## 🔗 第四步：连接前后端

### 4.1 修改前端API地址
现在需要修改前端代码中的API地址，让它连接到Railway后端：

1. **编辑 `index.html` 文件**：
   - 找到第1022行的API配置
   - 将 `https://your-app.railway.app` 替换为您的实际Railway URL

```javascript
const API_BASE_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' 
    ? 'http://localhost:8000' 
    : 'https://您的实际RailwayURL.railway.app'; // 替换这里
```

2. **提交更改**：
```bash
git add index.html
git commit -m "Update API URL to Railway backend"
git push origin main
```

### 4.2 重新部署前端
- GitHub Pages会自动检测到代码更改并重新部署
- 等待几分钟让更改生效

## ✅ 第五步：测试完整部署

### 5.1 测试前端
访问您的前端URL：`https://您的用户名.github.io/china-travel-recommender`

### 5.2 测试功能
1. **基本功能测试**：
   - 输入城市数量（如5）
   - 点击"随机推荐"按钮
   - 检查是否正常显示推荐城市

2. **API连接测试**：
   - 打开浏览器开发者工具（F12）
   - 查看Console标签
   - 应该看到"从后端API获取城市数据"的日志

3. **滚轮抽奖测试**：
   - 点击"选择困难？试试滚轮抽奖"
   - 测试滚轮抽奖功能
   - 检查天气信息是否正常显示

## 🎉 部署完成！

如果一切正常，您的应用现在应该：
- ✅ 前端运行在GitHub Pages上
- ✅ 后端API运行在Railway上
- ✅ 前后端正常通信
- ✅ 所有功能正常工作

## 🔧 故障排除

### 常见问题：

1. **API连接失败**：
   - 检查Railway URL是否正确
   - 确认Railway服务正在运行
   - 检查CORS设置

2. **GitHub Pages不更新**：
   - 等待几分钟让缓存更新
   - 强制刷新浏览器（Ctrl+F5）

3. **Railway部署失败**：
   - 检查 `requirements.txt` 文件
   - 确认 `server.py` 文件存在
   - 查看Railway部署日志

## 📞 需要帮助？

如果在部署过程中遇到问题，请：
1. 检查上述故障排除部分
2. 查看Railway和GitHub的部署日志
3. 确认所有URL和配置都正确

祝您部署成功！🎊
